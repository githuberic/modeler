# 消息接入内存分配的原理和源码分析
- SocketChannel 读取请求消息时，申请 bytebuffer-->未知大小-->小了则重新更大/1倍-->copy
- AdaptiveRecvByteBufAllocator 分配内存
    - 最小缓冲区内存为64个字节
    - 初始容量为1024字节
    - 最大容量为65535字节
    - 定义了2个动态调整容量的步进参数 扩张的步进索引为 4、收缩的步进索引为 1
    - 定义了SIZE_TABLE 长度向量表；
    
- 网关类产品的优化建议
    - 内存按需分配
    - 不要频繁的创建和释放对象，这会增加GC负担，降低系统吞吐量，可以使用内存池等机制优化内存的申请和释放
    - 减少对象copy
    - 流控机制