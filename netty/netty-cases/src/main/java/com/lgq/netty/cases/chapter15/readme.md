# Netty 事件触发策略使用不当的案例

## TCP 缓冲区分包
在业务上，一个完整的http报文可能会被tcp拆分成多个包发送，也有可能把多个小package封装成一个大的数据包发送，原因
- 应用程序写入的字节大小大于套接字发送缓冲区大小
- 进行MSS(最大报文长度)大小的tcp分段
- 以太网的有效负荷(payload) 大于 MTU 的IP分片
- 开启了TCP Nagle算法

底层无法保证数据包不被拆分和重组，只能通过上次的协议栈设计来解决； 根据业界主流解决方案
- 消息定长 如果不够 空位补空格
- 在包尾增加换行符进行分割，例如FTP
- 将消息分为消息头和消息体，消息头包含表示消息总长度(或消息体总长度)的字段，通常消息头的第一个字段使用int32表示消息总长度